
import UpdateAdmin from '@/app/dashboard/user-management/(crud)/update-admin';
import React, { useEffect, useRef, useState } from 'react';
import modal from '../modal';
import CustomModal from '../aside-modal/aside-modal';

interface Props {
    user: any;
    onLogout: () => void;
    title: string;
    dismiss: () => void;
}

export const UserProfile: React.FC<Props> = ({ user, onLogout, title, dismiss }) => {
    const [editAccount, setEditAccount] = useState(false)
    const userProfileRef = useRef<HTMLDivElement>(null);

    useEffect(() => {
        if (!editAccount) {
            const handleClickOutside = (event: MouseEvent) => {
                if (userProfileRef.current && !userProfileRef.current.contains(event.target as Node)) {
                    dismiss();
                }
            };
            document.addEventListener('mousedown', handleClickOutside);

            return () => {
                document.removeEventListener('mousedown', handleClickOutside);
            };
        }
    }, [dismiss]);
    return (<>
        {editAccount && (<>
            <CustomModal isOpen={editAccount} onClose={() => { setEditAccount(false) }} title={'Edit User'} subtitle={"Edit account information"}>
                <UpdateAdmin initialData={user} onRefresh={() => { setEditAccount(false) }} />
            </CustomModal>
        </>)}
        {!editAccount && (<>
            <div ref={userProfileRef} className="absolute top-[115px] right-10">
                <div className="w-[250px] h-auto rounded-lg py-9 px-[30px] bg-white-default shadow-drop relative">
                    <div className="absolute -top-[6px] right-8 w-[13.24px] h-[13.24px] bg-white-default" style={{ transform: 'rotate(135deg)' }}></div>
                    <div className='flex flex-col'>
                        <ul className='flex flex-col ga-[13px] leading-[25px]'>
                            <li className='text-orange-default text-lg'>{title}</li>
                            <li className='text-black-100 text-xl font-medium'>{user?.name}</li>
                            <li className='text-black-300 text-sm'>{user?.email}</li>
                        </ul>
                        <div className='w-full h-[1px] bg-black-500 mt-[25px]'></div>
                        <ul className='mt-[25px] flex flex-col w-full gap-7'>
                            <li className='w-full flex flex-row justify-between items-center'>
                                <button onClick={() => {
                                    setEditAccount(true)
                                }} className="w-full flex flex-row justify-between items-center">
                                    <span className='flex flex-row items-center gap-[11px] text-black-400 text-base'>
                                        <svg xmlns="http://www.w3.org/2000/svg" width="19" height="19" viewBox="0 0 19 19" fill="none">
                                            <path d="M16.6002 6.72579L16.2888 6.54211C16.2404 6.51359 16.2167 6.49927 16.1933 6.48444C15.9611 6.33695 15.7654 6.13317 15.6225 5.88937C15.6082 5.86484 15.5946 5.83912 15.5669 5.78827C15.5393 5.73749 15.5252 5.71176 15.5124 5.68629C15.3842 5.43265 15.3149 5.14999 15.3108 4.86229C15.3104 4.83337 15.3105 4.80382 15.3114 4.74507L15.3175 4.36165C15.3272 3.74808 15.3321 3.44035 15.2508 3.16417C15.1786 2.91886 15.0577 2.69291 14.8963 2.50116C14.7139 2.28441 14.4614 2.12978 13.9559 1.82091L13.536 1.56435C13.0319 1.25634 12.7798 1.10228 12.5121 1.04355C12.2754 0.99159 12.031 0.993998 11.7951 1.05015C11.5288 1.11353 11.2798 1.2716 10.7822 1.58757L10.7793 1.589L10.4785 1.78002C10.4309 1.81022 10.4068 1.82545 10.383 1.8395C10.1464 1.979 9.88219 2.05613 9.61159 2.06534C9.58431 2.06627 9.55657 2.06627 9.5011 2.06627C9.44597 2.06627 9.41704 2.06627 9.38982 2.06534C9.11863 2.05609 8.85392 1.97854 8.61693 1.83847C8.59304 1.82435 8.56941 1.809 8.52174 1.77866L8.21896 1.58592C7.71788 1.26696 7.46697 1.10724 7.19922 1.04355C6.96235 0.987197 6.71717 0.985638 6.47953 1.03827C6.21121 1.09769 5.95901 1.25289 5.45461 1.56329L5.45236 1.56435L5.03769 1.81953L5.0331 1.82251C4.53324 2.13012 4.28271 2.28429 4.10183 2.50016C3.94132 2.69171 3.82135 2.91731 3.74954 3.16197C3.66837 3.43852 3.67269 3.74692 3.68248 4.36338L3.68855 4.74625C3.68947 4.80423 3.69107 4.83304 3.69067 4.86156C3.68664 5.14984 3.61643 5.43308 3.48793 5.68717C3.47522 5.7123 3.46153 5.73743 3.43419 5.78762C3.40682 5.83785 3.39357 5.86283 3.37938 5.88707C3.23591 6.13217 3.03929 6.33714 2.80561 6.48488C2.7825 6.49949 2.75814 6.51355 2.71028 6.54167L2.40283 6.72232C1.8913 7.02289 1.63559 7.17331 1.44953 7.38736C1.28493 7.57672 1.16058 7.80134 1.08468 8.04596C0.99888 8.32248 0.998952 8.63256 1.00028 9.25265L1.00137 9.75947C1.00269 10.3754 1.0045 10.6832 1.09049 10.9578C1.16656 11.2008 1.29 11.4241 1.45368 11.6123C1.63869 11.8251 1.89185 11.9746 2.39951 12.274L2.70421 12.4537C2.75607 12.4843 2.78217 12.4994 2.80717 12.5154C3.03873 12.6632 3.23381 12.8676 3.37606 13.1113C3.39143 13.1377 3.40618 13.165 3.43568 13.2196C3.46481 13.2736 3.47972 13.3006 3.4932 13.3276C3.61792 13.578 3.68469 13.8562 3.68924 14.1393C3.68974 14.1699 3.68932 14.2008 3.68833 14.263L3.68248 14.6304C3.67263 15.249 3.66834 15.5586 3.74998 15.8359C3.82221 16.0813 3.94294 16.3072 4.10432 16.499C4.28674 16.7157 4.53962 16.8702 5.04516 17.1791L5.46498 17.4356C5.9691 17.7436 6.22107 17.8975 6.4887 17.9562C6.72547 18.0082 6.96995 18.0062 7.20587 17.95C7.47251 17.8866 7.72235 17.7279 8.22145 17.4111L8.52232 17.2201C8.56991 17.1898 8.59402 17.1747 8.61786 17.1606C8.85449 17.0211 9.11839 16.9436 9.38899 16.9344C9.41626 16.9335 9.444 16.9335 9.49948 16.9335C9.55508 16.9335 9.58279 16.9335 9.61012 16.9344C9.88131 16.9436 10.1468 17.0214 10.3838 17.1615C10.4047 17.1738 10.4256 17.1871 10.4622 17.2105L10.7821 17.4141C11.2832 17.7331 11.5336 17.8924 11.8014 17.9561C12.0383 18.0124 12.2836 18.0147 12.5213 17.9621C12.7895 17.9027 13.0422 17.7472 13.5463 17.4369L13.9673 17.1779C14.4674 16.8701 14.7182 16.7158 14.8992 16.4998C15.0597 16.3083 15.1798 16.0828 15.2516 15.8381C15.3322 15.5636 15.3273 15.2576 15.3177 14.65L15.3114 14.2537C15.3105 14.1958 15.3104 14.1669 15.3108 14.1384C15.3148 13.8501 15.3839 13.5667 15.5124 13.3126C15.5251 13.2875 15.5389 13.2622 15.5661 13.2121C15.5935 13.1619 15.6076 13.1369 15.6218 13.1126C15.7653 12.8675 15.9621 12.6624 16.1958 12.5147C16.2186 12.5002 16.2421 12.4864 16.2889 12.459L16.2905 12.4582L16.5979 12.2775C17.1094 11.977 17.3656 11.8264 17.5517 11.6123C17.7163 11.423 17.8405 11.1987 17.9164 10.954C18.0017 10.6791 18.001 10.3709 17.9997 9.75802L17.9986 9.24032C17.9973 8.62437 17.9966 8.31665 17.9106 8.042C17.8345 7.79902 17.7104 7.57572 17.5467 7.3875C17.3619 7.17495 17.1083 7.02542 16.6017 6.72656L16.6002 6.72579Z" stroke="#FF9D0D" strokeLinecap="round" strokeLinejoin="round" />
                                            <path d="M6.09894 9.50006C6.09894 11.4918 7.62177 13.1065 9.50027 13.1065C11.3788 13.1065 12.9016 11.4918 12.9016 9.50006C12.9016 7.50829 11.3788 5.89364 9.50027 5.89364C7.62177 5.89364 6.09894 7.50829 6.09894 9.50006Z" stroke="#FF9D0D" strokeLinecap="round" strokeLinejoin="round" />
                                        </svg>
                                        <span>Account</span>
                                    </span>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="7" height="12" viewBox="0 0 7 12" fill="none">
                                        <path d="M1 1L6 6L1 11" stroke="#FF9D0D" strokeLinecap="round" strokeLinejoin="round" />
                                    </svg>
                                </button>
                            </li>
                            <li className='w-full'>
                                <button onClick={onLogout} className='flex flex-row items-center gap-[11px] text-black-400 text-base'>
                                    <svg xmlns="http://www.w3.org/2000/svg" width="19" height="17" viewBox="0 0 19 17" fill="none">
                                        <path d="M10.8993 4.89557C10.7035 4.70079 10.3869 4.70158 10.1922 4.89733C9.99738 5.09308 9.99817 5.40966 10.1939 5.60443L10.8993 4.89557ZM13.3974 8.79193C13.5931 8.98671 13.9097 8.98592 14.1045 8.79017C14.2992 8.59442 14.2984 8.27784 14.1027 8.08307L13.3974 8.79193ZM14.1027 8.79193C14.2984 8.59716 14.2992 8.28058 14.1045 8.08483C13.9097 7.88908 13.5931 7.88829 13.3974 8.08307L14.1027 8.79193ZM10.1939 11.2706C9.99817 11.4653 9.99738 11.7819 10.1922 11.9777C10.3869 12.1734 10.7035 12.1742 10.8993 11.9794L10.1939 11.2706ZM13.75 8.9375C14.0261 8.9375 14.25 8.71364 14.25 8.4375C14.25 8.16136 14.0261 7.9375 13.75 7.9375V8.9375ZM1 7.9375C0.723858 7.9375 0.5 8.16136 0.5 8.4375C0.5 8.71364 0.723858 8.9375 1 8.9375V7.9375ZM10.1939 5.60443L13.3974 8.79193L14.1027 8.08307L10.8993 4.89557L10.1939 5.60443ZM13.3974 8.08307L10.1939 11.2706L10.8993 11.9794L14.1027 8.79193L13.3974 8.08307ZM13.75 7.9375H1V8.9375H13.75V7.9375Z" fill="#FF9D0D" />
                                        <path d="M5.25 11.625C5.25 13.9722 7.15279 15.875 9.5 15.875H13.75C16.0972 15.875 18 13.9722 18 11.625V5.25C18 2.90279 16.0972 1 13.75 1H9.5C7.15279 1 5.25 2.90279 5.25 5.25" stroke="#FF9D0D" strokeLinecap="round" strokeLinejoin="round" />
                                    </svg>
                                    <span>Log Out</span>
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </>)}
    </>)
}